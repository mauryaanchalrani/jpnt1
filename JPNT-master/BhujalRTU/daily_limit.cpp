/*
 * daily_limit.cpp
 *
 * Created: 02/11/2022 13:59:09
 *  Author: ADMIN
 */ 
#include "daily_limit.h"
#include "config.h"
#include "language.h"
#include "_debug.h"
#include "app_uart.h"
#include "common.h"
#include "..\..\..\..\..\toolchain\avr8\avr8-gnu-toolchain\avr\include\avr\pgmspace.h"
//industry id, jpnt limit, rspcb limit
 const daily_limit_t PROGMEM daily_limit_list[] = {
	{1  ,144,81 },
	{2  ,82 ,37 },
	{3  ,47 ,30 },
	{4  ,23 ,19 },
	{5  ,47 ,47 },
	{6  ,128,128},
	{7  ,22 ,22 },
	{8  ,47 ,47 },
	{9  ,159,159},
	{10 ,46 ,31 },
	{11 ,37 ,17 },
	{12 ,53 ,53 },
	{13 ,155,99 },
	{14 ,78 ,34 },
	{15 ,190,181},
	{17 ,30 ,30 },
	{18 ,27 ,27 },
	{19 ,19 ,19 },
	{20 ,11 ,11 },
	{21 ,15 ,15 },
	{22 ,112,112},
	{23 ,153,153},
	{24 ,67 ,67 },
	{25 ,46 ,46 },
	{26 ,21 ,21 },
	{27 ,76 ,75 },
	{28 ,105,39 },
	{29 ,63 ,47 },
	{30 ,40 ,23 },
	{31 ,90 ,90 },
	{32 ,347,354},
	{33 ,196,196},
	{35 ,45 ,71 },
	{36 ,165,200},
	{37 ,40 ,26 },
	{38 ,36 ,36 },
	{39 ,43 ,42 },
	{40 ,116,92 },
	{42 ,88 ,88 },
	{43 ,41 ,40 },
	{44 ,44 ,38 },
	{45 ,57 ,57 },
	{46 ,49 ,49 },
	{47 ,39 ,40 },
	{49 ,52 ,52 },
	{50 ,97 ,89 },
	{51 ,301,287},
	{52 ,49 ,49 },
	{53 ,27 ,27 },
	{54 ,85 ,80 },
	{55 ,53 ,29 },
	{56 ,333,333},
	{57 ,57 ,26 },
	{58 ,252,117},
	{59 ,64 ,65 },
	{60 ,94 ,89 },
	{61 ,121,97 },
	{62 ,31 ,19 },
	{63 ,84 ,43 },
	{64 ,80 ,80 },
	{65 ,29 ,29 },
	{66 ,41 ,27 },
	{67 ,28 ,16 },
	{68 ,38 ,33 },
	{69 ,48 ,28 },
	{70 ,33 ,33 },
	{71 ,32 ,28 },
	{72 ,32 ,27 },
	{73 ,32 ,23 },
	{74 ,33 ,20 },
	{75 ,66 ,41 },
	{76 ,36 ,36 },
	{77 ,136,66 },
	{79 ,46 ,33 },
	{80 ,65 ,49 },
	{81 ,77 ,63 },
	{82 ,28 ,28 },
	{83 ,98 ,67 },
	{84 ,63 ,62 },
	{85 ,37 ,34 },
	{86 ,85 ,85 },
	{87 ,57 ,43 },
	{88 ,52 ,37 },
	{89 ,37 ,35 },
	{91 ,24 ,23 },
	{92 ,72 ,72 },
	{93 ,78 ,26 },
	{94 ,37 ,21 },
	{95 ,40 ,36 },
	{96 ,84 ,76 },
	{97 ,23 ,23 },
	{98 ,23 ,23 },
	{99 ,39 ,12 },
	{100,24 ,19 },
	{101,40 ,30 },
	{102,20 ,16 },
	{103,46 ,17 },
	{104,16 ,16 },
	{105,36 ,37 },
	{106,17 ,17 },
	{107,48 ,44 },
	{109,73 ,48 },
	{110,78 ,66 },
	{115,53 ,52 },
	{116,18 ,18 },
	{117,98 ,96 },
	{118,97 ,97 },
	{119,73 ,39 },
	{120,56 ,34 },
	{121,96 ,96 },
	{122,26 ,19 },
	{123,161,161},
	{124,54 ,53 },
	{125,48 ,38 },
	{126,26 ,20 },
	{127,72 ,72 },
	{128,47 ,47 },
	{129,72 ,72 },
	{130,23 ,22 },
	{131,80 ,80 },
	{132,32 ,20 },
	{133,154,136},
	{134,49 ,36 },
	{135,60 ,47 },
	{136,66 ,46 },
	{137,44 ,31 },
	{138,34 ,24 },
	{139,50 ,50 },
	{140,58 ,73 },
	{141,40 ,39 },
	{142,98 ,98 },
	{143,30 ,26 },
	{144,67 ,67 },
	{145,127,100},
	{146,39 ,30 },
	{148,49 ,40 },
	{149,55 ,55 },
	{150,41 ,26 },
	{151,48 ,48 },
	{152,91 ,91 },
	{153,77 ,135},
	{154,116,116},
	{155,123,122},
	{156,44 ,44 },
	{157,52 ,52 },
	{158,73 ,74 },
	{159,100,56 },
	{160,85 ,43 },
	{161,31 ,28 },
	{162,149,158},
	{163,75 ,75 },
	{164,41 ,26 },
	{165,86 ,85 },
	{166,87 ,49 },
	{167,92 ,43 },
	{168,78 ,50 },
	{169,50 ,32 },
	{170,19 ,19 },
	{171,54 ,54 },
	{172,62 ,39 },
	{173,36 ,36 },
	{174,48 ,38 },
	{175,40 ,40 },
	{176,17 ,17 },
	{177,145,65 },
	{178,36 ,36 },
	{179,37 ,28 },
	{180,45 ,37 },
	{181,95 ,94 },
	{182,20 ,20 },
	{183,38 ,31 },
	{185,56 ,56 },
	{186,30 ,30 },
	//{187,1  ,0  },
	{188,92 ,92 },
	{189,42 ,28 },
	{190,76 ,68 },
	{191,171,94 },
	{192,29 ,29 },
	{193,19 ,19 },
	{194,72 ,72 },
	{195,38 ,27 },
	{196,41 ,35 },
	{197,96 ,88 },
	{198,21 ,20 },
	{199,74 ,20 },
	{200,48 ,48 },
	{201,43 ,27 },
	{202,61 ,61 },
	{203,35 ,31 },
	{204,299,297},
	{205,33 ,22 },
	{206,48 ,42 },
	{207,82 ,49 },
	{208,88 ,88 },
	{209,48 ,47 },
	{210,44 ,43 },
	{211,30 ,25 },
	{212,63 ,52 },
	{213,45 ,42 },
	{214,50 ,20 },
	{215,47 ,29 },
	{216,28 ,27 },
	{217,48 ,32 },
	{218,33 ,27 },
	{219,69 ,69 },
	{220,145,123},
	{221,52 ,46 },
	{222,76 ,76 },
	{223,63 ,38 },
	{224,95 ,45 },
	{225,470,464},
	{226,81 ,80 },
	{227,36 ,36 },
	{228,46 ,46 },
	{230,63 ,63 },
	{231,33 ,25 },
	{233,45 ,37 },
	{234,40 ,36 },
	{235,33 ,32 },
	{236,44 ,22 },
	{237,46 ,45 },
	{239,32 ,26 },
	{240,49 ,48 },
	{241,86 ,86 },
	{242,44 ,20 },
	{243,57 ,57 },
	{244,79 ,79 },
	{245,42 ,29 },
	{246,25 ,20 },
	{247,32 ,33 },
	{248,39 ,38 },
	{249,22 ,22 },
	{250,44 ,44 },
	{251,38 ,34 },
	{252,25 ,19 },
	{253,47 ,40 },
	{254,46 ,41 },
	{255,32 ,23 },
	{256,46 ,26 },
	{257,39 ,39 },
	{258,41 ,41 },
	{260,40 ,39 },
	{261,41 ,41 },
	{262,46 ,25 },
	{263,43 ,43 },
	{264,34 ,32 },
	{265,38 ,15 },
	{266,30 ,30 },
	{267,80 ,80 },
	{268,59 ,59 },
	{269,43 ,43 },
	{270,40 ,30 },
	{271,67 ,44 },
	{272,46 ,23 },
	{273,97 ,97 },
	{274,38 ,29 },
	{275,106,15 },
	{276,30 ,30 },
	{277,174,174},
	{278,30 ,30 },
	{279,67 ,49 },
	{280,39 ,14 },
	{281,65 ,15 },
	{282,44 ,31 },
	{283,29 ,29 },
	{284,72 ,72 },
	{285,30 ,30 },
	{286,42 ,42 },
	{287,33 ,32 },
	{288,45 ,30 },
	{289,119,56 },
	{290,49 ,26 },
	{292,58 ,36 },
	{293,26 ,20 },
	{295,40 ,14 },
	{296,71 ,70 },
	{297,38 ,27 },
	{298,37 ,36 },
	{299,84 ,82 },
	{300,56 ,36 },
	{301,39 ,39 },
	{302,127,82 },
	{303,61 ,43 },
	{304,55 ,55 },
	{305,50 ,44 },
	{306,73 ,73 },
	{307,55 ,55 },
	{308,38 ,23 },
	{309,52 ,52 },
	{310,13 ,0 },
	{311,131,131},
	{312,30 ,0 },
	{313,80 ,0 },
	{314,30 ,0 },
	{315,30 ,0 },
	{316,23 ,0 },
	{317,37 ,16 },
	{318,30 ,0 },
	{319,30 ,0 },
	{320,68 ,0 },
	{321,20 ,0 },
	{322,48 ,42 },
	{323,98 ,40 },
	{397,18500,18500},
	{398,18500,18500},
	{997,7  ,6  },
	{998,10 ,8  },
	{999,9  ,4  },
	{0xFFFF,0,0}
};

unsigned int get_daily_limit(unsigned int id)
{
	unsigned int table_id, table_jpnt_lim, table_rspcb_lim;
	unsigned int i = 0;

	while(1)
	{
		table_id = pgm_read_word(&daily_limit_list[i].industry_id);
		table_jpnt_lim = pgm_read_word(&daily_limit_list[i].jpnt_limit);
		table_rspcb_lim = pgm_read_word(&daily_limit_list[i].rspcb_limit);
		
		if(table_id == 0xFFFF)
		{
			break;
		}
		else if(table_id == id)
		{
#if DAILY_LIMIT_TYPE == JPNT_LIMIT
			return table_jpnt_lim;
#elif DAILY_LIMIT_TYPE == RSPCB_LIMIT
			return table_rspcb_lim;
#endif			
		}
		i++;
	}
	return 0;
}

unsigned int read_rom_mem(char *ptr)
{
	return pgm_read_word(ptr);
}